"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const x=require("react"),A=require("../../contexts/form/form.cjs.js"),C=require("../../hooks/use-event-listener.cjs.js"),h=require("./ach.styles.cjs.js"),L=require("./ach.utils.cjs.js");function M(n){if(n&&n.__esModule)return n;const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const s in n)if(s!=="default"){const i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(a,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}return a.default=n,Object.freeze(a)}const e=M(x);function w({accountHolderName:n,intent:a,total:s,redirectURI:i,transactionId:g,callbacks:l,buttonProps:_,children:m,svgProps:j}){const[o,k]=e.useState(()=>{}),[z,p]=e.useState(!1),{cardTokenizeResponseReceived:R,payments:y}=A.useForm(),u=e.useRef(null),S=async r=>{if(r.stopPropagation(),!o){console.warn("ACH button was clicked, but no ACH instance was found.");return}try{await o.tokenize({accountHolderName:n,intent:a,total:s})}catch(t){console.error(t)}},b=async r=>{p(!0);try{const{tokenResult:t}=r.detail;if(t&&t.status==="OK")return await R(t);let f=`Tokenization failed with status: ${t?.status}`;if(t?.errors)throw f+=` and errors: ${JSON.stringify(t?.errors)}`,new Error(f)}catch(t){console.error(t)}finally{p(!1)}};if(e.useEffect(()=>(o?.addEventListener("ontokenization",b),()=>{o?.removeEventListener("ontokenization",b)}),[o]),e.useEffect(()=>{const r=new AbortController,{signal:t}=r;return(async d=>{const P=await y?.ach({redirectURI:i,transactionId:g}).then(v=>{if(!d?.aborted)return k(v),v});d.aborted&&await P?.destroy()})(t),()=>{r.abort()}},[y]),l)for(const r of Object.keys(l))o?.addEventListener(L.transformPlaidEventName(r),l[r]);C.useEventListener({listener:S,type:"click",element:u,options:{passive:!0}});const{isLoading:O,...E}=_??{},c=O||!o||z;return m?e.createElement(h.PayButton,{...E,"aria-disabled":c,disabled:c,ref:u,type:"button"},m):e.createElement(h.PayButton,{...E,"aria-disabled":c,disabled:c,ref:u,type:"button"},e.createElement(h.SvgIcon,{fill:"none",height:"1em",viewBox:"0 0 36 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...j},e.createElement("rect",{fill:"url(#prefix__paint0_linear)",height:24,rx:4,width:36}),e.createElement("path",{clipRule:"evenodd",d:"M18.509 6.16a.89.89 0 00-1.018 0l-6.124 4.285a.848.848 0 00-.325.96.873.873 0 00.833.595h1.75v4.286h-1.75a.866.866 0 00-.875.857c0 .473.392.857.875.857h12.25a.866.866 0 00.875-.857.866.866 0 00-.875-.857h-1.75V12h1.75c.38 0 .717-.24.833-.596a.848.848 0 00-.324-.959L18.509 6.16zm2.116 10.126V12h-5.25v4.286h5.25zM18 7.91l3.395 2.376h-6.79L18 7.91z",fill:"#fff",fillRule:"evenodd"}),e.createElement("defs",null,e.createElement("linearGradient",{gradientUnits:"userSpaceOnUse",id:"prefix__paint0_linear",x1:36,x2:0,y1:12,y2:12},e.createElement("stop",{stopColor:"#01D09E"}),e.createElement("stop",{offset:1,stopColor:"#03E4AE"})))),e.createElement("span",null,"Pay with Direct debit (ACH)"))}exports.Ach=w;exports.default=w;
//# sourceMappingURL=ach.cjs.js.map
